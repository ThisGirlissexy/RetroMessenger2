<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<!-- ****************************************************** -->
<!--            Standard wxWidgets header                   -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8"/>
    <title>wxWidgets: wxString Overview</title>
    <meta name="author" content="wxWidgets team"/>
    <meta name="created" content="Sat Sep 6 10:17:57 2008"/>
    <meta name="keywords" content="wxWidgets"/>
    <link href="wxwidgets.css" rel="stylesheet" type="text/css"/>
    <link href="tabs.css" rel="stylesheet" type="text/css"/>
</head>
<body>


<!--          End of wxWidgets standard header           -->
<!-- *************************************************** -->

<!-- Generated by Doxygen 1.5.6 -->
<script type="text/javascript">
<!--
function changeDisplayState (e){
  var num=this.id.replace(/[^[0-9]/g,'');
  var button=this.firstChild;
  var sectionDiv=document.getElementById('dynsection'+num);
  if (sectionDiv.style.display=='none'||sectionDiv.style.display==''){
    sectionDiv.style.display='block';
    button.src='open.gif';
  }else{
    sectionDiv.style.display='none';
    button.src='closed.gif';
  }
}
function initDynSections(){
  var divs=document.getElementsByTagName('div');
  var sectionCounter=1;
  for(var i=0;i<divs.length-1;i++){
    if(divs[i].className=='dynheader'&&divs[i+1].className=='dynsection'){
      var header=divs[i];
      var section=divs[i+1];
      var button=header.firstChild;
      if (button!='IMG'){
        divs[i].insertBefore(document.createTextNode(' '),divs[i].firstChild);
        button=document.createElement('img');
        divs[i].insertBefore(button,divs[i].firstChild);
      }
      header.style.cursor='pointer';
      header.onclick=changeDisplayState;
      header.id='dynheader'+sectionCounter;
      button.src='closed.gif';
      section.id='dynsection'+sectionCounter;
      section.style.display='none';
      section.style.marginLeft='14px';
      sectionCounter++;
    }
  }
}
window.onload = initDynSections;
-->
</script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="classes.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    <li>
      <form action="search.php" method="get">
        <table cellspacing="0" cellpadding="0" border="0">
          <tr>
            <td><label>&nbsp;<u>S</u>earch&nbsp;for&nbsp;</label></td>
            <td><input type="text" name="query" value="" size="20" accesskey="s"/></td>
          </tr>
        </table>
      </form>
    </li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="index.html">wxWidgets 2.9.0: A portable C++ GUI toolkit</a>&nbsp;&raquo&nbsp;<a class="el" href="page_topics.html">Topic Overviews</a>
  </div>
</div>
<div class="contents">
<h1><a class="anchor" name="overview_string"><a class="el" href="classwx_string.html">wxString</a> Overview </a></h1>Classes: <a class="el" href="classwx_string.html">wxString</a>, <a class="el" href="classwx_array_string.html">wxArrayString</a>, <a class="el" href="classwx_string_tokenizer.html">wxStringTokenizer</a><p>
<ul>
<li><a class="el" href="overview_string.html#overview_string_intro">Introduction</a> </li>
<li><a class="el" href="overview_string.html#overview_string_comparison">Comparison to Other String Classes</a> </li>
<li><a class="el" href="overview_string.html#overview_string_advice">Advice About Using wxString</a> </li>
<li><a class="el" href="overview_string.html#overview_string_related">String Related Functions and Classes</a> </li>
<li><a class="el" href="overview_string.html#overview_string_tuning">Tuning wxString for Your Application</a></li>
</ul>
<hr>
<h2><a class="anchor" name="overview_string_intro">
Introduction</a></h2>
<a class="el" href="classwx_string.html">wxString</a> is a class which represents a character string of arbitrary length and containing arbitrary characters. The ASCII NUL character is allowed, but be aware that in the current string implementation some methods might not work correctly in this case.<p>
Since wxWidgets 3.0 <a class="el" href="classwx_string.html">wxString</a> internally uses UCS-2 (basically 2-byte per character wchar_t) under Windows and UTF-8 under Unix, Linux and OS X to store its content. Much work has been done to make existing code using ANSI string literals work as before.<p>
This class has all the standard operations you can expect to find in a string class: dynamic memory management (string extends to accommodate new characters), construction from other strings, C strings, wide character C strings and characters, assignment operators, access to individual characters, string concatenation and comparison, substring extraction, case conversion, trimming and padding (with spaces), searching and replacing and both C-like <code>printf</code> (<a class="el" href="classwx_string.html#fb76f7340136980d9e69510db8f39df9">wxString::Printf</a>) and stream-like insertion functions as well as much more - see <a class="el" href="classwx_string.html">wxString</a> for a list of all functions.<h2><a class="anchor" name="overview_string_comparison">
Comparison to Other String Classes</a></h2>
The advantages of using a special string class instead of working directly with C strings are so obvious that there is a huge number of such classes available. The most important advantage is the need to always remember to allocate/free memory for C strings; working with fixed size buffers almost inevitably leads to buffer overflows. At last, C++ has a standard string class (std::string). So why the need for <a class="el" href="classwx_string.html">wxString</a>? There are several advantages:<p>
<ul>
<li><b>Efficiency:</b> Since wxWidgets 3.0 <a class="el" href="classwx_string.html">wxString</a> uses std::string (UTF8 mode under Linux, Unix and OS X) or std::wstring (MSW) internally by default to store its constent. <a class="el" href="classwx_string.html">wxString</a> will therefore inherit the performance characteristics from std::string. </li>
<li><b>Compatibility:</b> This class tries to combine almost full compatibility with the old wxWidgets 1.xx <a class="el" href="classwx_string.html">wxString</a> class, some reminiscence to MFC CString class and 90% of the functionality of std::string class. </li>
<li><b>Rich set of functions:</b> Some of the functions present in <a class="el" href="classwx_string.html">wxString</a> are very useful but don't exist in most of other string classes: for example, <a class="el" href="classwx_string.html#1605126b7bbf5f60a6fca7f393a58f1d">wxString::AfterFirst</a>, <a class="el" href="classwx_string.html#52179a8f357d852d1ad88775939de49b">wxString::BeforeLast</a>, wxString::operators or <a class="el" href="classwx_string.html#fb76f7340136980d9e69510db8f39df9">wxString::Printf</a>. Of course, all the standard string operations are supported as well. </li>
<li><b>Unicode <a class="el" href="classwx_string.html">wxString</a> is Unicode friendly:</b> it allows to easily convert to and from ANSI and Unicode strings (see the <a class="el" href="overview_unicode.html">unicode overview</a> for more details) and maps to <code>wstring</code> transparently. </li>
<li><b>Used by wxWidgets:</b> And, of course, this class is used everywhere inside wxWidgets so there is no performance loss which would result from conversions of objects of any other string class (including std::string) to <a class="el" href="classwx_string.html">wxString</a> internally by wxWidgets.</li>
</ul>
However, there are several problems as well. The most important one is probably that there are often several functions to do exactly the same thing: for example, to get the length of the string either one of <a class="el" href="classwx_string.html#f63f200410b56436a830550905e20539">wxString::length()</a>, <a class="el" href="classwx_string.html#b20a87ca731a52c36ec674dae2213ad8">wxString::Len()</a> or <a class="el" href="classwx_string.html#8895cca03120099236c002c0577b4d1c">wxString::Length()</a> may be used. The first function, as almost all the other functions in lowercase, is std::string compatible. The second one is the "native" <a class="el" href="classwx_string.html">wxString</a> version and the last one is the wxWidgets 1.xx way.<p>
So which is better to use? The usage of the std::string compatible functions is strongly advised! It will both make your code more familiar to other C++ programmers (who are supposed to have knowledge of std::string but not of <a class="el" href="classwx_string.html">wxString</a>), let you reuse the same code in both wxWidgets and other programs (by just typedefing <a class="el" href="classwx_string.html">wxString</a> as std::string when used outside wxWidgets) and by staying compatible with future versions of wxWidgets which will probably start using std::string sooner or later too.<p>
In the situations where there is no corresponding std::string function, please try to use the new <a class="el" href="classwx_string.html">wxString</a> methods and not the old wxWidgets 1.xx variants which are deprecated and may disappear in future versions.<h2><a class="anchor" name="overview_string_advice">
Advice About Using wxString</a></h2>
Probably the main trap with using this class is the implicit conversion operator to <code>const char*</code>. It is advised that you use <a class="el" href="classwx_string.html#7b03261d7b716ef7d11c8c304971c457">wxString::c_str()</a> instead to clearly indicate when the conversion is done. Specifically, the danger of this implicit conversion may be seen in the following code fragment:<p>
<div class="fragment"><pre class="fragment"><span class="comment">// this function converts the input string to uppercase,</span>
<span class="comment">// output it to the screen and returns the result</span>
<span class="keyword">const</span> <span class="keywordtype">char</span> *SayHELLO(<span class="keyword">const</span> <a class="code" href="classwx_string.html">wxString</a>&amp; input)
{
    <a class="code" href="classwx_string.html">wxString</a> output = input.<a class="code" href="classwx_string.html#b84d4b6e9f38ba939d61f3382d2a009b">Upper</a>();
    printf(<span class="stringliteral">"Hello, %s!\n"</span>, output);
    <span class="keywordflow">return</span> output;
}
</pre></div><p>
There are two nasty bugs in these three lines. The first is in the call to the <code>printf()</code> function. Although the implicit conversion to C strings is applied automatically by the compiler in the case of<p>
<div class="fragment"><pre class="fragment">puts(output);
</pre></div><p>
because the argument of <code>puts()</code> is known to be of the type <code>const char*</code>, this is <b>not</b> done for <code>printf()</code> which is a function with variable number of arguments (and whose arguments are of unknown types). So this call may do any number of things (including displaying the correct string on screen), although the most likely result is a program crash. The solution is to use <a class="el" href="classwx_string.html#7b03261d7b716ef7d11c8c304971c457">wxString::c_str()</a>. Just replace this line with this:<p>
<div class="fragment"><pre class="fragment">printf(<span class="stringliteral">"Hello, %s!\n"</span>, output.<a class="code" href="classwx_string.html#7b03261d7b716ef7d11c8c304971c457">c_str</a>());
</pre></div><p>
The second bug is that returning <code>output</code> doesn't work. The implicit cast is used again, so the code compiles, but as it returns a pointer to a buffer belonging to a local variable which is deleted as soon as the function exits, its contents are completely arbitrary. The solution to this problem is also easy, just make the function return <a class="el" href="classwx_string.html">wxString</a> instead of a C string.<p>
This leads us to the following general advice: all functions taking string arguments should take <code>const <a class="el" href="classwx_string.html">wxString</a></code> (this makes assignment to the strings inside the function faster) and all functions returning strings should return <a class="el" href="classwx_string.html">wxString</a> - this makes it safe to return local variables.<h2><a class="anchor" name="overview_string_related">
String Related Functions and Classes</a></h2>
As most programs use character strings, the standard C library provides quite a few functions to work with them. Unfortunately, some of them have rather counter-intuitive behaviour (like <code>strncpy()</code> which doesn't always terminate the resulting string with a <span class="literal">NULL</span>) and are in general not very safe (passing <span class="literal">NULL</span> to them will probably lead to program crash). Moreover, some very useful functions are not standard at all. This is why in addition to all <a class="el" href="classwx_string.html">wxString</a> functions, there are also a few global string functions which try to correct these problems: <a class="el" href="group__group__funcmacro__string.html#g7e7d54ff05379ed1cc7c69d4d62e78d2">wxIsEmpty()</a> verifies whether the string is empty (returning <span class="literal">true</span> for <span class="literal">NULL</span> pointers), <a class="el" href="group__group__funcmacro__string.html#g94679d1beadd290b6754d43e587d1be9">wxStrlen()</a> also handles <span class="literal">NULL</span> correctly and returns 0 for them and <a class="el" href="group__group__funcmacro__string.html#g3c7fa69f3add8719e3ae533c34a95041">wxStricmp()</a> is just a platform-independent version of case-insensitive string comparison function known either as <code>stricmp()</code> or <code>strcasecmp()</code> on different platforms.<p>
The <code>&lt;<a class="el" href="interface_2wx_2string_8h.html">wx/string.h</a>&gt;</code> header also defines wxSnprintf and wxVsnprintf functions which should be used instead of the inherently dangerous standard <code>sprintf()</code> and which use <code>snprintf()</code> instead which does buffer size checks whenever possible. Of course, you may also use <a class="el" href="classwx_string.html#fb76f7340136980d9e69510db8f39df9">wxString::Printf</a> which is also safe.<p>
There is another class which might be useful when working with <a class="el" href="classwx_string.html">wxString</a>: <a class="el" href="classwx_string_tokenizer.html">wxStringTokenizer</a>. It is helpful when a string must be broken into tokens and replaces the standard C library <code>strtok()</code> function.<p>
And the very last string-related class is <a class="el" href="classwx_array_string.html">wxArrayString</a>: it is just a version of the "template" dynamic array class which is specialized to work with strings. Please note that this class is specially optimized (using its knowledge of the internal structure of <a class="el" href="classwx_string.html">wxString</a>) for storing strings and so it is vastly better from a performance point of view than a wxObjectArray of wxStrings.<h2><a class="anchor" name="overview_string_tuning">
Tuning wxString for Your Application</a></h2>
<dl class="note" compact><dt><b>Note:</b></dt><dd>This section is strictly about performance issues and is absolutely not necessary to read for using <a class="el" href="classwx_string.html">wxString</a> class. Please skip it unless you feel familiar with profilers and relative tools.</dd></dl>
For the performance reasons <a class="el" href="classwx_string.html">wxString</a> doesn't allocate exactly the amount of memory needed for each string. Instead, it adds a small amount of space to each allocated block which allows it to not reallocate memory (a relatively expensive operation) too often as when, for example, a string is constructed by subsequently adding one character at a time to it, as for example in:<p>
<div class="fragment"><pre class="fragment"><span class="comment">// delete all vowels from the string</span>
<a class="code" href="classwx_string.html">wxString</a> DeleteAllVowels(<span class="keyword">const</span> <a class="code" href="classwx_string.html">wxString</a>&amp; original)
{
    <a class="code" href="classwx_string.html">wxString</a> vowels( <span class="stringliteral">"aeuioAEIOU"</span> );
    <a class="code" href="classwx_string.html">wxString</a> result;
    wxString::const_iterator i;
    <span class="keywordflow">for</span> ( i = original.<a class="code" href="classwx_string.html#d59ca2dd208720b3cce07d90bcb90093">begin</a>(); i != original.<a class="code" href="classwx_string.html#6a0f235fff88df5e6b16b5f0e1e719cc">end</a>(); ++i )
    {
        <span class="keywordflow">if</span> (vowels.Find( *i ) == wxNOT_FOUND)
            result += *i;
    }

    <span class="keywordflow">return</span> result;
}
</pre></div><p>
This is quite a common situation and not allocating extra memory at all would lead to very bad performance in this case because there would be as many memory (re)allocations as there are consonants in the original string. Allocating too much extra memory would help to improve the speed in this situation, but due to a great number of <a class="el" href="classwx_string.html">wxString</a> objects typically used in a program would also increase the memory consumption too much.<p>
The very best solution in precisely this case would be to use <a class="el" href="classwx_string.html#87e614d9924a1b5524334aac3fc96d38">wxString::Alloc()</a> function to preallocate, for example, len bytes from the beginning - this will lead to exactly one memory allocation being performed (because the result is at most as long as the original string).<p>
However, using <a class="el" href="classwx_string.html#87e614d9924a1b5524334aac3fc96d38">wxString::Alloc()</a> is tedious and so <a class="el" href="classwx_string.html">wxString</a> tries to do its best. The default algorithm assumes that memory allocation is done in granularity of at least 16 bytes (which is the case on almost all of wide-spread platforms) and so nothing is lost if the amount of memory to allocate is rounded up to the next multiple of 16. Like this, no memory is lost and 15 iterations from 16 in the example above won't allocate memory but use the already allocated pool.<p>
The default approach is quite conservative. Allocating more memory may bring important performance benefits for programs using (relatively) few very long strings. The amount of memory allocated is configured by the setting of <code>EXTRA_ALLOC</code> in the file string.cpp during compilation (be sure to understand why its default value is what it is before modifying it!). You may try setting it to greater amount (say twice nLen) or to 0 (to see performance degradation which will follow) and analyse the impact of it on your program. If you do it, you will probably find it helpful to also define <code>WXSTRING_STATISTICS</code> symbol which tells the <a class="el" href="classwx_string.html">wxString</a> class to collect performance statistics and to show them on stderr on program termination. This will show you the average length of strings your program manipulates, their average initial length and also the percent of times when memory wasn't reallocated when string concatenation was done but the already preallocated memory was used (this value should be about 98% for the default allocation policy, if it is less than 90% you should really consider fine tuning <a class="el" href="classwx_string.html">wxString</a> for your application).<p>
It goes without saying that a profiler should be used to measure the precise difference the change to <code>EXTRA_ALLOC</code> makes to your program. </div>
<!-- ******************************************************* -->
<!--             Standard wxWidgets footer                   -->

<!-- NOTE: <br/> must go inside <p> but <hr/> must go outside -->
<p><br/></p><hr/>

<table width="100%" border="0">
<tr>
    <td align="left">
        <a href="http://www.wxwidgets.org/" style="margin-left: 0px">
            <img src="powered-by-wxwidgets.png" alt="wxWidgets logo" border="0"/>
        </a>
    </td>
    <td valign="middle" align="center"><p class="footer">Page generated <tt>Sat Sep 6 10:17:57 2008</tt> by <a href="http://www.doxygen.org/">Doxygen</a> 1.5.6</p></td>
    <td valign="middle" align="right"><p>[ <a href="wsdindex.html#top" class="top">top</a> ]</p></td>
</tr>
</table>

<script src="wxwidgets.js" type="text/javascript"></script>

<script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
    var pageTracker = _gat._getTracker("UA-794025-2");
    pageTracker._initData();
    pageTracker._trackPageview();
</script>

</body>
</html>

<!-- ***************************************************** -->
<!--         End of wxWidgets standard footer              -->
